# 面向对象之 对象类型

## 前言

最近学习了 JS的对象相关知识，所以做一下小结

目录

1 [对象概述](#1)

  - [1.1 对象的含义](#1.1)

  - [1.2 对象的属性](#1.2)

2 [属性的操作](#2)

  - [2.1 读取属性](#2.1)

  - [2.2 查看属性](#2.2)

  - [2.3 删除属性](#2.3)

3 [with语句](#3)

## <span id="1">一  对象概述</span>

### <span id="1.1">1.1 对象的含义</span>

1 Q: 什么是对象

A: 1 对象就是一组“键值对”（key-value）的集合，它是JS里的复杂数据类型，在内存中用堆表示

```
var obj = {         // 大括号就定义了一个对象, 被赋值给变量obj
  foo: 'Hello',     // 键值对之间用逗号分隔
  bar: 'World'
}

```

### <span id="1.2">1.2 对象的属性</span>

1 Q: 对象的key有什么注意点 

A: S1 对象的每一个键名又称为“属性”,  所有属性类型 都是字符串(ES6引入了Symbol类型，也可以作为键名)

S2 如果键名是数值，会被自动转为字符串

```js
var obj = {
  1: 'a',
  1e-2: true,   // 所有键名虽然看上去像数值，实际上都被自动转成了字符串
  0xFF: true
}

obj

// Object {
//   1: "a",
//   0.01: true,
//   255: true
// }

obj['100']      // true
```

S3 如果键名不符合标识名的条件，就必须加上引号，否则会报错

```js
var obj = {
  1p: 'Hello World'       // 报错 
}

var obj = {               // 不报错
  '1p': 'Hello World',
  'h w': 'Hello World',
  'p+q': 'Hello World'
}
```

2 Q: 什么是方法，如何可以产生"链式调用"

A: S1 如果一个属性的值为函数，这个属性就称为“方法”，它可以像函数那样调用

S2 如果属性的值还是一个对象，就形成了链式引用

```js
var o1 = {}
var o2 = { bar: 'hello' }

o1.foo = o2   // 对象o1的属性foo指向对象o2，就可以链式引用o2的属性
o1.foo.bar    // "hello"


## <span id="2">二 属性的操作</span>

### <span id="2.1">2.1 读取属性</span>

1 Q: 如何 读取对象的属性

A: S1 有两种方法，一种是使用 点运算符，一种是使用 方括号运算符

```js
var obj = {
  p: 'Hello World'
}

obj.p       // "Hello World"
obj['p']    // "Hello World"
```

S2 注意，使用方括号运算符，键名必须放在引号里面，否则会被当作变量处理
```JS
var foo = 'bar'

var obj = {
  foo: 1,
  bar: 2
}

obj.foo    // 1  使用点运算符，foo就是字符串
obj[foo]   // 2  使用方括号运算符，但是不使用引号， 那么foo就是一个变量，指向字符串bar
```

S3 注意，数值键名不能使用点运算符（会被当成小数点），只能使用方括号运算符

```JS
var obj = {
  123: 'hello world'
}

obj.123    // 报错
obj[123]   // "hello world"
```

### <span id="2.2">2.2 查看属性</span>

1 Q: 如何 查看一个对象的所有属性

A: S1 使用Object.keys方法 (查看一个对象 本身的所有属性)

```js
var obj = {
  key1: 1,
  key2: 2
}

Object.keys(obj)    // ['key1', 'key2']
```

S2 in运算符用于检查对象是否包含某个属性(名)，如果包含就返回true，否则返回false;

注意，它不能识别哪些属性是对象自身的，哪些属性是继承的

```js
var obj = { p: 1 }
'p' in obj           // true
'toString' in obj   // true
```

可以使用对象的hasOwnProperty方法判断一下，是否为对象自身的属性:

```js
var obj = {}
if ('toString' in obj) {
  console.log(obj.hasOwnProperty('toString'))   // false
}
```

S3 可以用 for...in来遍历 一个对象的全部属性;

注意， 它会跳过对象里不可遍历的属性 + 它不仅遍历对象自身的属性，还遍历继承的属性

```js
var obj = {a: 1, b: 2, c: 3}

for (var i in obj) {
  console.log('键名：', i)
  console.log('键值：', obj[i])
}
// 键名： a    键值： 1
// 键名： b    键值： 2
// 键名： c    键值： 3

```

一般情况下，都是只想遍历对象自身的属性，所以使用for...in的时候，可结合使用hasOwnProperty方法
```js
var person = { name: '老张' }
for (var key in person) {
  if (person.hasOwnProperty(key)) {
    console.log(key);
  }
}

// name
```

### <span id="2.3">2.3 删除属性</span>

1 Q: 如何 删除一个对象的某个属性

A: S1 delete命令 用于删除对象的属性，删除成功后返回true

```js
var obj = { p: 1 }
Object.keys(obj)     // ["p"]

delete obj.p        // true
obj.p               // undefined
```

S2 注意，删除一个不存在的属性，delete不报错，而且返回true; 因此，不能根据delete命令的结果，认定某个属性是存在的

```JS
var obj = {}
delete obj.p // true
```

S3 只有一种情况，delete命令会返回false: 那就是该属性存在，且不得删除

```JS
var obj = Object.defineProperty({}, 'p', {
  value: 123,
  configurable: false       // 使 p属性不能删除
})

obj.p          // 123
delete obj.p   // false

```
S4 delete命令只能删除对象本身的属性，无法删除继承的属性;  说明即使delete返回true，该属性依然可能读取到值

```JS
var obj = {}
delete obj.toString   // true,  虽然返回true，但该属性并没有被删除
obj.toString          // function toString() { [native code] }
```

## <span id="3">三 with语句</span>

1 Q: with语句的语法是什么, 有什么作用

A: S1 语法见下:

```js
with (对象) {
  语句
}
```

S2 它的作用是操作同一个对象的多个属性时，提供一些书写的方便

```JS
// 例一
var obj = {
  p1: 1,
  p2: 2,
}

with (obj) {
  p1 = 4
  p2 = 5
}
// 等同于
obj.p1 = 4
obj.p2 = 5


// 例二
with (document.links[0]){
  console.log(href)
  console.log(title)
  console.log(style)
}

// 等同于
console.log(document.links[0].href);
console.log(document.links[0].title);
console.log(document.links[0].style);
```

S3 注意，如果with内部有 变量的赋值操作，必须是当前对象已经存在的属性，否则会创造一个全局变量
```JS
var obj = {}
with (obj) {
  p1 = 4    // 创造了一个全局变量p1
  p2 = 5
}

obj.p1 // undefined
p1    // 4
```

所以这造成了with语句的一个很大的弊病，就是 绑定对象不明确;  这不利于代码的除错和模块化,也拖慢了运行速度
```js
with (obj) {
  console.log(x)  // 无法判断x到底是全局变量，还是对象obj的一个属性
}
```

S4 所以建议不要使用with语句


以上可参考

[01 阮一峰教程— 数据类型-对象](https://wangdoc.com/javascript/types/object.html)