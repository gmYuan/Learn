{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{228:function(t,a,e){\"use strict\";e.r(a);var v=e(28),s=Object(v.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":t.$parent.slotKey}},[e(\"h1\",{attrs:{id:\"网络之-浏览器缓存详解\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#网络之-浏览器缓存详解\"}},[t._v(\"#\")]),t._v(\" 网络之 浏览器缓存详解\")]),t._v(\" \"),e(\"h3\",{attrs:{id:\"目录\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#目录\"}},[t._v(\"#\")]),t._v(\" 目录\")]),t._v(\" \"),e(\"p\",[t._v(\"1 \"),e(\"a\",{attrs:{href:\"#1\"}},[t._v(\"预读文档\")])]),t._v(\" \"),e(\"p\",[t._v(\"2 \"),e(\"a\",{attrs:{href:\"#2\"}},[t._v(\"缓存原因\")])]),t._v(\" \"),e(\"p\",[t._v(\"3 \"),e(\"a\",{attrs:{href:\"#3\"}},[t._v(\"缓存类型\")])]),t._v(\" \"),e(\"p\",[t._v(\"4 \"),e(\"a\",{attrs:{href:\"#4\"}},[t._v(\"缓存应用\")])]),t._v(\" \"),e(\"h2\",{attrs:{id:\"一-预读文档\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#一-预读文档\"}},[t._v(\"#\")]),t._v(\" \"),e(\"span\",{attrs:{id:\"1\"}},[t._v(\"一 预读文档 \")])]),t._v(\" \"),e(\"p\",[t._v(\"01 \"),e(\"a\",{attrs:{href:\"https://juejin.im/post/5c22ee806fb9a049fb43b2c5\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"一文读懂前端缓存\"),e(\"OutboundLink\")],1)]),t._v(\" \"),e(\"p\",[t._v(\"02 \"),e(\"a\",{attrs:{href:\"https://zhuanlan.zhihu.com/p/28113197\",target:\"_blank\",rel:\"noopener noreferrer\"}},[t._v(\"设计一个无懈可击的浏览器缓存方案\"),e(\"OutboundLink\")],1)]),t._v(\" \"),e(\"p\",[t._v(\"阅读原因: 直接 参考文档\")]),t._v(\" \"),e(\"h2\",{attrs:{id:\"二-缓存原因\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#二-缓存原因\"}},[t._v(\"#\")]),t._v(\" \"),e(\"span\",{attrs:{id:\"2\"}},[t._v(\"二 缓存原因 \")])]),t._v(\" \"),e(\"p\",[t._v(\"Q1: 为什么要引入缓存\")]),t._v(\" \"),e(\"p\",[t._v(\"A:\")]),t._v(\" \"),e(\"p\",[t._v(\"S1 减少冗余的 数据传输\")]),t._v(\" \"),e(\"p\",[t._v(\"S2 减少了服务器的负担\")]),t._v(\" \"),e(\"p\",[t._v(\"S3 提高了客户端的 加载速度\")]),t._v(\" \"),e(\"h2\",{attrs:{id:\"三-缓存类型\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#三-缓存类型\"}},[t._v(\"#\")]),t._v(\" \"),e(\"span\",{attrs:{id:\"3\"}},[t._v(\" 三 缓存类型 \")])]),t._v(\" \"),e(\"p\",[t._v(\"Q1: 缓存有哪些类型\")]),t._v(\" \"),e(\"p\",[t._v(\"A:\")]),t._v(\" \"),e(\"p\",[t._v(\"S1 从浏览器缓存的位置来看，可以分为\")]),t._v(\" \"),e(\"p\",[t._v(\"(1) Service Worker: 由开发者 手动控制 缓存内容和策略 + 永久缓存;\")]),t._v(\" \"),e(\"p\",[t._v(\"(2) Memory Cache:\")]),t._v(\" \"),e(\"blockquote\",[e(\"p\",[t._v(\"1 内存缓存, 页面关闭后该次浏览的 memory cache就失效\")])]),t._v(\" \"),e(\"blockquote\",[e(\"p\",[t._v(\"2 主要存储2类资源: preloader的资源(如 video) + \"),e(\"code\",[t._v('<link rel=\"preload\">显式指定的 预加载资源')])])]),t._v(\" \"),e(\"blockquote\",[e(\"p\",[t._v(\"3 Memory Cache的 设置优先值 大于 Disk Cache部分的设置\")])]),t._v(\" \"),e(\"p\",[t._v(\"(3) Disk Cache： 硬盘缓存，也叫 HTTP cache，它是持久存储的\")]),t._v(\" \"),e(\"p\",[t._v(\"S2 从失效判断来看，可以分为 \"),e(\"code\",[t._v(\"强缓存 和 协商缓存\")])]),t._v(\" \"),e(\"br\"),t._v(\" \"),e(\"p\",[t._v(\"Q2: 介绍一下 强缓存\")]),t._v(\" \"),e(\"p\",[t._v(\"A:\")]),t._v(\" \"),e(\"p\",[t._v(\"S1 强缓存：客户端发起请求 --\\x3e 到 缓存中查看是否过期 --\\x3e 未过期则直接返回; 过期则向服务器发起请求\")]),t._v(\" \"),e(\"p\",[t._v(\"S2 \"),e(\"code\",[t._v(\"Expires: Thu, 10 Nov 2017 08:45:11 GMT\")]),t._v(\": 缓存到期的 绝对时间\")]),t._v(\" \"),e(\"blockquote\",[e(\"p\",[t._v(\"可能由于 客户端修改本地时间 / 时差  等原因导致 缓存失效\")])]),t._v(\" \"),e(\"p\",[t._v(\"S3 \"),e(\"code\",[t._v(\"Cache-control: max-age=2592000\")]),t._v(\": 资源缓存的最大有效时间\")]),t._v(\" \"),e(\"p\",[t._v(\"Cache-control的其他可选值示例:\")]),t._v(\" \"),e(\"div\",{staticClass:\"language-http extra-class\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-http\"}},[e(\"code\",[e(\"span\",{pre:!0,attrs:{class:\"token header-name keyword\"}},[t._v(\"public:\")]),t._v(\" 资源允许被 中间服务器缓存\\n\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token header-name keyword\"}},[t._v(\"private:\")]),t._v(\" 资源不允许 被中间代理服务器缓存\\n\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token header-name keyword\"}},[t._v(\"no-cache:\")]),t._v(\" 需要进行协商缓存，需要发送请求到服务器 确认是否使用缓存\\n\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token header-name keyword\"}},[t._v(\"no-store:\")]),t._v(\" 禁止使用缓存，每一次都要重新请求数据\\n\\n\"),e(\"span\",{pre:!0,attrs:{class:\"token header-name keyword\"}},[t._v(\"must-revalidate:\")]),t._v(\" 可以缓存，但是使用之前 必须先向源服务器确认\\n\")])])]),e(\"p\",[t._v(\"S4 Cache-control 的优先级高于 Expires\")]),t._v(\" \"),e(\"p\",[t._v(\"Q3: 介绍一下 协商缓存\")]),t._v(\" \"),e(\"p\",[t._v(\"A:\")]),t._v(\" \"),e(\"p\",[t._v(\"S1 协商缓存: 由服务器根据缓存内容是否发生变化 来判断缓存 是否失效\")]),t._v(\" \"),e(\"p\",[t._v(\"S2.1 \"),e(\"code\",[t._v(\"Last-Modified & If-Modified-Since: Mon, 10 Nov 2018 09:10:11 GMT\")]),t._v(\": 资源最后一次被修改的时间\")]),t._v(\" \"),e(\"p\",[t._v(\"S2.2 时间单位最低是秒,不能识别1s内的资源内容 发生了变化,所以 不会更新Last-Modified值\")]),t._v(\" \"),e(\"p\",[t._v(\"S2.3 当文件内容反悔修改时，文件内容实质没有发生变化，但还是会 更新Last-Modified值\")]),t._v(\" \"),e(\"p\",[t._v(\"S3 \"),e(\"code\",[t._v(\"Etag & If-None-Match\")]),t._v(\": 文件内容的标识\")]),t._v(\" \"),e(\"p\",[t._v(\"S4 Etag 的优先级高于 Last-Modified\")]),t._v(\" \"),e(\"p\",[t._v(\"Q4: 缓存判断的 整体流程\")]),t._v(\" \"),e(\"p\",[t._v(\"A:\")]),t._v(\" \"),e(\"blockquote\",[e(\"p\",[t._v(\"S1 当浏览器要请求资源时，查看 Service Worker 的 fetch 事件响应\")])]),t._v(\" \"),e(\"blockquote\",[e(\"p\",[t._v(\"S2 查看 memory cache\")])]),t._v(\" \"),e(\"blockquote\",[e(\"p\",[t._v(\"S3 查看 disk cache:\")])]),t._v(\" \"),e(\"blockquote\",[e(\"p\",[t._v(\"S3.1 如果有强缓存 且未失效，则使用强制缓存，不请求服务器; 这时的状态码全部是 200\")])]),t._v(\" \"),e(\"blockquote\",[e(\"p\",[t._v(\"S3.2 如果有强制缓存 但已失效，使用协商缓存，比较后确定 304 还是 200\")])]),t._v(\" \"),e(\"blockquote\",[e(\"p\",[t._v(\"S4 发送网络请求，等待网络响应\")])]),t._v(\" \"),e(\"blockquote\",[e(\"p\",[t._v(\"S5 把响应内容存入 disk cache\")])]),t._v(\" \"),e(\"blockquote\",[e(\"p\",[t._v(\"S6 把响应内容的引用 存入 memory cache (无视 HTTP 头信息的配置)\")])]),t._v(\" \"),e(\"blockquote\",[e(\"p\",[t._v(\"S7 把响应内容存入 Service Worker 的 Cache Storage (如果 Service Worker 调用了 cache.put())\")])]),t._v(\" \"),e(\"p\",[e(\"img\",{attrs:{src:\"https://user-gold-cdn.xitu.io/2019/1/21/1686e2735297a596?imageView2/0/w/1280/h/960/format/webp/ignore-error/1\",alt:\"缓存判断流程\"}})]),t._v(\" \"),e(\"h2\",{attrs:{id:\"四-缓存应用\"}},[e(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#四-缓存应用\"}},[t._v(\"#\")]),t._v(\" \"),e(\"span\",{attrs:{id:\"4\"}},[t._v(\"四 缓存应用 \")])]),t._v(\" \"),e(\"p\",[t._v(\"Q1: 如何配置 缓存\")]),t._v(\" \"),e(\"p\",[t._v(\"A:\")]),t._v(\" \"),e(\"p\",[t._v(\"S1 HTML 等经常变化的资源：使用协商缓存\")]),t._v(\" \"),e(\"p\",[t._v(\"S2 CSS&JS&图片 等不常变化的资源：使用强缓存，文件命名带上hash值\")]),t._v(\" \"),e(\"div\",{staticClass:\"language-HTML extra-class\"},[e(\"pre\",{pre:!0,attrs:{class:\"language-html\"}},[e(\"code\",[e(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[e(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"<\")]),t._v(\"script\")]),t._v(\" \"),e(\"span\",{pre:!0,attrs:{class:\"token attr-name\"}},[t._v(\"src\")]),e(\"span\",{pre:!0,attrs:{class:\"token attr-value\"}},[e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"=\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')]),t._v(\"http://test.com/a.【hash值】.js\"),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v('\"')])]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\">\")])]),e(\"span\",{pre:!0,attrs:{class:\"token script\"}}),e(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[e(\"span\",{pre:!0,attrs:{class:\"token tag\"}},[e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"</\")]),t._v(\"script\")]),e(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\">\")])]),t._v(\"\\n\")])])])])}),[],!1,null,null,null);a.default=s.exports}}]);","extractedComments":[]}