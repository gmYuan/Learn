# 网络之 HTTP报文


Q1: HTTP报文的基础结构是什么

A:
S1 HTTP报文由 4部分构成：
  - 起始行(start line)：可以分为 “请求行”/“响应行”
  - 头部字段(header)
  - CRLF换行
  - 消息实体(entity/body)

S2 其中，起始行和头部字段，常被合称为 “请求头” / “响应头”

S3  HTTP协议规定，报文内的body是可选的，所以报文特点是 “头重脚轻”

------
Q2.1 什么是请求行

A:
S1  作用：请求行描述了 `客户端想要 如何操作 服务器端的资源 `

S2 请求行由 3部分构成：
  - 请求方法：是一个动词，如 GET/POST，描述了如何 对资源进行操作
  - 请求目标：通常是一个 URI，标记了请求方法  要操作的资源
  - 版本号：说明报文所使用的  HTTP协议版本
  - 如 `GET / HTTP/1.1` 

![请求行构成图](https://gitee.com/ygming/blog-img/raw/master/img/http_2.png)

------
Q2.2 什么是状态行

A：
S1  作用：描述了 服务器响应的状态，重点是状态，所以叫做状态行 而不是 响应行

S2 状态由 3部分构成：
  - 版本号：表示报文使用的 HTTP 协议版本
  - 状态码：用一个三位数表示处理的结果
  - 原因：作为数字状态码补充，是更详细的解释性文字
  - 如 ` HTTP/1.1 200 OK` 

![状态行构成图](https://gitee.com/ygming/blog-img/raw/master/img/http_3.png)

------
Q3.1 头部字段(header)是什么

A: 
S1 作用：由 `key: value`的键值对构成，用来补充说明解释报文的其他信息

S2 头部字段可以分为 4种类型：
  - 通用字段：在请求头和响应头中 都可以出现
  - 请求字段：只能出现在请求头，进一步说明请求信息 / 额外的附加条件
  - 响应字段：只能出现在响应头，补充说明 响应报文的信息
  - 实体字段：它实际上属于通用字段，但专门用于描述 body的额外信息

------
Q3.2 有哪些常见的 通用字段

A：
S1 Date字段
  - 通常出现在响应头里，表示 HTTP 报文创建的时间
  - 客户端可以使用这个时间，搭配其他字段 决定缓存策略

--------
Q3.3 有哪些常见的 请求字段

A：
S1 Host字段
  - 它属于请求字段，同时也是唯一一个 HTTP/1.1规范里 要求的必有字段
  - Host字段 告诉服务器这个请求应该由哪个主机来处理
  - 当一台计算机上托管了多个虚拟主机时，服务器端 就需要用 Host字段来选择

S2 User-Agent字段
  - 它使用一个字符串来描述发起 HTTP 请求的客户端
  - 服务器可以依据它来返回最合适此浏览器显示的页面

-------
Q3.4 有哪些常见的 响应字段

A：
S1 Server字段
  - 它告诉客户端 当前正在提供 Web服务的 软件名称和版本号
  - 它不是必须要出现的，因为这会把服务器的信息暴露给外界，如果这个版本恰好存在 bug，那么就有可能被其他人 利用 bug攻击服务器

-------
Q3.5 有哪些常见的 实体字段

A：
S1 Content-Length字段
  - 它表示报文里 body 的长度
  - 服务器看到这个字段，就知道了后续有多少数据，可以直接接收
  - 如果没有这个字段，那么 body就是不定长的，需要使用 chunked方式分段传输

---------
Q4 HTTP 请求行/起始行中，有哪些类型的 请求方法  

A:
S1 GET
  - 获取资源内容
  - GET 搭配 URI/其他头字段，就能实现对资源访问 更精细的操作
  - 如 在 URI 后使用 "#"，就可以在获取页面后  直接定位到某个标签所在的位置
  - 使用 Range字段就是 "范围请求"，只获取资源的一部分数据
  - GET是 安全且幂等的

S2 HEAD
  - 获取资源的元信息，即指返回 响应头而不返回资源的body
  - 如 想要检查一个文件是否存在，只要发个 HEAD 请求就可以了
  - HEAD是 安全且幂等的

S3 POST
  - 向资源提交数据，用以 创建资源内的某条数据，效果类似于 Insert
  - POST是 非幂等的

S4 PUT
  - 类似于POST, 用以 更新资源内的某条数据，效果类似于 Updae
    - PUT是 幂等的

S5 DElETE
   - 删除资源

S6 CONNECT
  - 要求服务器 为客户端和另一台远程服务器建立一条特殊的连接隧道
  - 这时 Web服务器 在中间充当了 代理  的角色

S7 OPTIONS
  - 列出该资源对外提供的可使用的 请求方法，在响应头的 Allow 字段里返回

S8 TRACE
  - 追踪展示 该资源 从请求到响应间的 输出路径
  - 该方法 会泄漏网站的信息，所以 Web服务器通常会 禁止使用